!function(){"use strict";var e="undefined"!=typeof window?window:global;if("function"!=typeof e.require){var t={},r={},i=function(e,t){return{}.hasOwnProperty.call(e,t)},n=function(e,t){var r,i,n=[];r=/^\.\.?(\/|$)/.test(t)?[e,t].join("/").split("/"):t.split("/");for(var s=0,a=r.length;a>s;s++)i=r[s],".."===i?n.pop():"."!==i&&""!==i&&n.push(i);return n.join("/")},s=function(e){return e.split("/").slice(0,-1).join("/")},a=function(t){return function(r){var i=s(t),a=n(i,r);return e.require(a,t)}},o=function(e,t){var i={id:e,exports:{}};return r[e]=i,t(i.exports,a(e),i),i.exports},l=function(e,s){var a=n(e,".");if(null==s&&(s="/"),i(r,a))return r[a].exports;if(i(t,a))return o(a,t[a]);var l=n(a,"./index");if(i(r,l))return r[l].exports;if(i(t,l))return o(l,t[l]);throw new Error('Cannot find module "'+e+'" from "'+s+'"')},u=function(e,r){if("object"==typeof e)for(var n in e)i(e,n)&&(t[n]=e[n]);else t[e]=r},c=function(){var e=[];for(var r in t)i(t,r)&&e.push(r);return e};e.require=l,e.require.define=u,e.require.register=u,e.require.list=c,e.require.brunch=!0}}(),require.register("collections/frames",function(e,t,r){var i=t("../models/frame"),n=Backbone.Collection.extend({model:i,initialize:function(){for(var e=n.NUM_FRAMES;e--;)this.push(new i);this.at(n.NUM_FRAMES-1).set("extendable",!0),this.currentFrameIndex=0},getCurrentFrame:function(){return this.at(this.currentFrameIndex)},handleSpare:function(){var e=this.getCurrentFrame(),t=this.at(this.currentFrameIndex-1);t&&t.isSpare()&&t.set("total",t.get("total")+e.get("results")[0])},handleStrike:function(){var e=this.getCurrentFrame(),t=this.at(this.currentFrameIndex-1),r=this.at(this.currentFrameIndex-2);t&&t.isStrike()&&(t.set("total",t.get("total")+e.getTotal()),r&&r.isStrike()&&this.currentFrameIndex!==n.NUM_FRAMES-1&&r.set("total",r.get("total")+e.get("results")[0]))},tally:function(e){var t=this.getCurrentFrame();t.set("played",!0),t.tally(e),t.isClosed()&&(this.handleSpare(),this.handleStrike(),this.currentFrameIndex+=1,this.trigger("new-frame"))},getTotalScore:function(){return _.reduce(this.models,function(e,t){return e+t.get("total")},0)}});n.NUM_FRAMES=10,r.exports=n}),require.register("initialize",function(e,t){t("lib/helpers"),t("routers/main"),$(function(){Backbone.history.start({pushState:!0})})}),require.register("lib/helpers",function(){Handlebars.registerHelper("times",function(e,t){for(var r="",i=0;e>i;++i)r+=t.fn(i);return r})}),require.register("models/frame",function(e,t,r){var i=Backbone.Model.extend({defaults:function(){return{results:[],total:0,played:!1,extendable:!1}},initialize:function(){this.frameLength=i.DEFAULT_LENGTH},tally:function(e){var t=this.get("results");this.isClosed()||(t.push(e),this.set("total",this.getTotal()),this.trigger("change:total",this,this.get("total")),this.trigger("change:results",this,t)),this.get("extendable")&&this.extendIfNeeded()},isClosed:function(){return!this.get("extendable")&&(this.isStrike()||this.get("results").length===this.frameLength)||this.get("extendable")&&this.get("results").length===this.frameLength},isStrike:function(){return 10===this.get("results")[0]},isSpare:function(){var e=this.get("results");return e[0]<10&&e[0]+e[1]===10},getTotal:function(){return _.reduce(this.get("results"),function(e,t){return e+t},0)},getNumPins:function(){this.get("results");return i.NUM_PINS-this.getTotal()},extendIfNeeded:function(){(this.isSpare()||this.isStrike())&&(this.frameLength=3)},formattedResults:function(){var e="",t=this.get("played"),r=this.get("results");return t?(e+=10===r[0]?"X":r[0]+" ",this.isStrike()&&!this.get("extendable")?e:(e+=this.isSpare()?"/":0===r[1]?"-":void 0===r[1]?" ":r[1],e+=_.reduce(r.slice(2),function(e,t){return e+t+" "},""))):e},formattedTotal:function(){return this.get("played")?this.get("total"):""},toJSON:function(){var e=_.clone(this.attributes);return e.results=this.formattedResults(),e.total=this.formattedTotal(),e.numPins=this.getNumPins(),e}});i.NUM_PINS=10,i.DEFAULT_LENGTH=2,r.exports=i}),require.register("routers/main",function(e,t,r){var i=Backbone.Router.extend({routes:{"":"index"},index:function(){var e=t("views/app");this.appView=new e}});i=new i,r.exports=i}),require.register("views/app",function(e,t,r){var i=t("./game");r.exports=Backbone.View.extend({el:"body",initialize:function(){new i}})}),require.register("views/frame",function(e,t,r){var i=(t("../models/frame"),t("./templates/frame"));r.exports=Backbone.View.extend({el:".deck",template:i,initialize:function(){this.listenTo(this.model,"change:results",this.render),this.render()},render:function(){return this.$el.html(this.template({frame:this.model.toJSON()})),this}})}),require.register("views/frames",function(e,t,r){var i=(t("../collections/frames"),t("../views/frame")),n=t("./templates/frames"),s=t("./templates/game-over");r.exports=Backbone.View.extend({el:".scoreboard",template:n,gameOverTemplate:s,initialize:function(){this.$alley=$(".alley"),this.$bowlButton=$(".bowl",this.$alley),this.currentFrameView=new i({model:this.collection.getCurrentFrame()}),this.listenTo(this.collection,"change:total",this.render),this.listenTo(this.collection,"new-frame",this.newFrame),this.render()},render:function(){return this.$el.html(this.template({frames:this.collection.toJSON()})),this},newFrame:function(){var e=this,t=this.collection.getCurrentFrame();t?(this.$bowlButton.prop("disabled",!0),setTimeout(function(){e.currentFrameView=new i({model:e.collection.getCurrentFrame()}),e.$bowlButton.prop("disabled",!1)},500)):this.$alley.html(this.gameOverTemplate({score:this.collection.getTotalScore()}))}})}),require.register("views/game",function(e,t,r){var i=(t("../models/frame"),t("../collections/frames")),n=t("./frames");r.exports=Backbone.View.extend({el:".alley",events:{"click button.bowl":"bowl"},initialize:function(){this.frames=new i,this.framesView=new n({collection:this.frames})},bowl:function(){var e=this.frames.getCurrentFrame().getNumPins();this._bowl(Math.round(Math.random()*e))},_bowl:function(e){this.frames.tally(e)}})}),require.register("views/templates/frame",function(e,t,r){var i=Handlebars.template(function(e,t,r,i,n){function s(e,t){var i,n,s,o="";return o+='\n<ul class="pins clearfix">\n  ',n=r.times||e&&e.times,s={hash:{},inverse:c.noop,fn:c.program(2,a,t),data:t},i=n?n.call(e,e&&e.numPins,s):h.call(e,"times",e&&e.numPins,s),(i||0===i)&&(o+=i),o+="\n</ul>\n"}function a(){return'\n  <li class="pin"></li>\n  '}this.compilerInfo=[4,">= 1.0.0"],r=this.merge(r,e.helpers),n=n||{};var o,l,u,c=this,h=r.helperMissing,f="function",m=r.blockHelperMissing;return u={hash:{},inverse:c.noop,fn:c.program(1,s,n),data:n},(l=r.frame)?o=l.call(t,u):(l=t&&t.frame,o=typeof l===f?l.call(t,u):l),r.frame||(o=m.call(t,o,{hash:{},inverse:c.noop,fn:c.program(1,s,n),data:n})),o||0===o?o:""});"function"==typeof define&&define.amd?define([],function(){return i}):"object"==typeof r&&r&&r.exports&&(r.exports=i)}),require.register("views/templates/frames",function(e,t,r){var i=Handlebars.template(function(e,t,r,i,n){function s(e,t){var i,n,s="";return s+='\n  <li class="frame">\n    <div class="results">',(n=r.results)?i=n.call(e,{hash:{},data:t}):(n=e&&e.results,i=typeof n===l?n.call(e,{hash:{},data:t}):n),s+=u(i)+'</div>\n    <div class="running-total">',(n=r.total)?i=n.call(e,{hash:{},data:t}):(n=e&&e.total,i=typeof n===l?n.call(e,{hash:{},data:t}):n),s+=u(i)+"</div>\n  </li>\n  "}this.compilerInfo=[4,">= 1.0.0"],r=this.merge(r,e.helpers),n=n||{};var a,o="",l="function",u=this.escapeExpression,c=this;return o+='<ul class="frames clearfix">\n  ',a=r.each.call(t,t&&t.frames,{hash:{},inverse:c.noop,fn:c.program(1,s,n),data:n}),(a||0===a)&&(o+=a),o+="\n</ul>"});"function"==typeof define&&define.amd?define([],function(){return i}):"object"==typeof r&&r&&r.exports&&(r.exports=i)}),require.register("views/templates/game-over",function(e,t,r){var i=Handlebars.template(function(e,t,r,i,n){this.compilerInfo=[4,">= 1.0.0"],r=this.merge(r,e.helpers),n=n||{};var s,a,o="",l="function",u=this.escapeExpression;return o+='<div class="game-over">\n  <p>GAME OVER</p>\n  <p>',(a=r.score)?s=a.call(t,{hash:{},data:n}):(a=t&&t.score,s=typeof a===l?a.call(t,{hash:{},data:n}):a),o+=u(s)+'</p>\n  <a href="/">PLAY AGAIN</a>\n</div>'});"function"==typeof define&&define.amd?define([],function(){return i}):"object"==typeof r&&r&&r.exports&&(r.exports=i)});